<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8"/>
        <meta name="viewport" content="width=device-width,initial-scale=1"/>
        <title>Orders · Loyalty Console</title>
        <!-- Fonts + Bootstrap + Icons -->
        <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
        <!-- App styles -->
        <link rel="icon" type="image/x-icon" href="images/datatech-ico.ico">
        <link rel="stylesheet" href="css/style.css">
        <link rel="stylesheet" href="css/sidebar.css">
        <style>
    /* small helpers for the top controls */
    .toolbar .form-select, .toolbar .form-control { height: 36px; padding: 6px 10px; }
    .toolbar .btn-icon { width: 36px; height: 36px; display:inline-flex; align-items:center; justify-content:center; }
    .orders-tabs .nav-link { border:0; }
    .orders-tabs .nav-link.active { background:#eef2ff; color:#1f2937; font-weight:600; }
    .table thead th { white-space: nowrap; }
    .table tbody td { vertical-align: middle; }
  </style>
    </head>
    <body>
        <div class="layout">
            <!-- Sidebar (shared) -->
            <aside class="sidebar" id="sidebar" data-include="partials/sidebar.html"></aside>
            <div class="main">
                <!-- Topbar (shared) -->
                <div data-include="partials/topbar.html"></div>
                <main class="page">
                    <div class="container-narrow">
                        <!-- Title + toolbar -->
                        <div class="d-flex align-items-center justify-content-between mb-2">
                            <h1 class="h5 fw-bold mb-0">Orders</h1>
                            <div class="toolbar d-flex align-items-center gap-2">
                                <select id="filterBranch" class="form-select form-select-sm" style="min-width: 180px;">
                                    <option value="">All Branches</option>
                                    <option>AHB | Abu Halifa</option>
                                    <option>SLB | Salmiya</option>
                                    <option>JRB | Jahra</option>
                                    <option>ADB | Ardiya</option>
                                </select>
                                <input id="filterBizDate" type="date" class="form-control form-control-sm"/>
                                <button id="btnExport" class="btn btn-outline-secondary btn-sm"><i class="fa-solid fa-file-export me-1"></i>Export
                                </button>
                                <button id="btnRefresh" class="btn btn-outline-secondary btn-sm btn-icon" title="Refresh"><i class="fa-solid fa-rotate"></i>
                                </button>
                                <button id="btnFilter" class="btn btn-outline-secondary btn-sm"><i class="fa-solid fa-filter me-1"></i>Filter
                                </button>
                            </div>
                        </div>
                        <!-- Tabs -->
                        <ul class="nav nav-pills small orders-tabs mb-2">
                            <li class="nav-item">
                                <button class="nav-link active" data-tab="all">All</button>
                            </li>
                            <li class="nav-item">
                                <button class="nav-link" data-tab="today">Today</button>
                            </li>
                            <li class="nav-item">
                                <button class="nav-link" data-tab="draft">Draft</button>
                            </li>
                            <li class="nav-item">
                                <button class="nav-link" data-tab="pending">Pending</button>
                            </li>
                            <li class="nav-item">
                                <button class="nav-link" data-tab="active">Active</button>
                            </li>
                            <li class="nav-item">
                                <button class="nav-link" data-tab="ahead">Ahead</button>
                            </li>
                            <li class="nav-item">
                                <button class="nav-link" data-tab="callcenter">Call Center</button>
                            </li>
                            <li class="nav-item">
                                <button class="nav-link" data-tab="api">API</button>
                            </li>
                        </ul>
                        <!-- Table -->
                        <div class="dt-card p-card">
                            <div class="table-responsive">
                                <table class="table align-middle mb-0">
                                    <thead>
                                        <tr>
                                            <th style="width:36px;">
                                                <input type="checkbox" id="chkAll">
                                            </th>
                                            <th>Reference</th>
                                            <th>Number</th>
                                            <th>Branch</th>
                                            <th>Customer</th>
                                            <th>Status</th>
                                            <th>Source</th>
                                            <th class="text-end">Total</th>
                                            <th>Business Date</th>
                                            <th>Opened At</th>
                                        </tr>
                                    </thead>
                                    <tbody id="ordersBody"></tbody>
                                </table>
                            </div>
                            <!-- Pager -->
                            <div class="d-flex justify-content-between align-items-center mt-2 small text-muted">
                                <div id="pagerText">Showing 1–10 of 120</div>
                                <div class="d-flex gap-2">
                                    <button class="btn btn-outline-secondary btn-sm" id="prevPage">Previous</button>
                                    <button class="btn btn-outline-secondary btn-sm" id="nextPage">Next</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </main>
            </div>
        </div>
        <!-- JS -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
        <script src="js/dt-include.js"></script>
        <script src="js/sidebar.js" defer></script>
        <script src="js/app-user.js" defer></script>
        <script>
  (function(){
    // --- Demo data ----------------------------------------------------------
    const demoRows = [
      { ref:1770662, num:35,  branch:'AHB | Abu Halifa', customer:'Khwaja koti - 253218<br>6586 1990', status:'Done', source:'Cashier', kwd:0,    bdate:'2025-08-16', opened:'August 16, 03:32pm' },
      { ref:1770661, num:31,  branch:'ADB | Ardiya',     customer:'—',                                status:'Done', source:'Cashier', kwd:4.40, bdate:'2025-08-16', opened:'August 16, 03:29pm' },
      { ref:1770660, num:137, branch:'SLB | Salmiya',    customer:'mohammed aburumuh - 397548<br>6633 1534', status:'Done', source:'Cashier', kwd:1.50, bdate:'2025-08-16', opened:'August 16, 03:28pm' },
      { ref:1770659, num:81,  branch:'JRB | Jahra',      customer:'Bader - 401516<br>6616 7722', status:'Done', source:'Cashier', kwd:1.25, bdate:'2025-08-16', opened:'August 16, 03:23pm' },
      { ref:1770658, num:136, branch:'SLB | Salmiya',    customer:'—', status:'Done', source:'Cashier', kwd:1.75, bdate:'2025-08-16', opened:'August 16, 03:23pm' },
      { ref:1770657, num:135, branch:'SLB | Salmiya',    customer:'—', status:'Done', source:'Cashier', kwd:4.45, bdate:'2025-08-16', opened:'August 16, 03:22pm' },
      { ref:1770656, num:134, branch:'SLB | Salmiya',    customer:'—', status:'Done', source:'Cashier', kwd:0.95, bdate:'2025-08-16', opened:'August 16, 03:21pm' },
      { ref:1770655, num:68,  branch:'SLB | Salmiya',    customer:'Fuad Majed Al_Ghazali - 839164<br>588 81127', status:'Done', source:'Cashier', kwd:1.95, bdate:'2025-08-16', opened:'August 16, 03:18pm' },
      { ref:1770654, num:133, branch:'SLB | Salmiya',    customer:'—', status:'Done', source:'Cashier', kwd:4.20, bdate:'2025-08-16', opened:'August 16, 03:20pm' },
      { ref:1770653, num:80,  branch:'JRB | Jahra',      customer:'—', status:'Done', source:'Cashier', kwd:4.50, bdate:'2025-08-16', opened:'August 16, 03:16pm' }
    ];

    // --- Render -------------------------------------------------------------
    const $body = document.getElementById('ordersBody');
    const fmtKWD = v => 'KWD ' + Number(v||0).toLocaleString(undefined,{minimumFractionDigits:3, maximumFractionDigits:3});

    function renderRows(rows){
      $body.innerHTML = rows.map(r => `
        <tr>
          <td><input type="checkbox"></td>
          <td><a href="order-details.html?id=${r.ref}">${r.ref}</a></td>
          <td>${r.num}</td>
          <td>${r.branch}</td>
          <td>${r.customer}</td>
          <td><span class="badge text-bg-success">${r.status}</span></td>
          <td>${r.source}</td>
          <td class="text-end">${fmtKWD(r.kwd)}</td>
          <td>${r.bdate}</td>
          <td>${r.opened}</td>
        </tr>
      `).join('');
      document.getElementById('pagerText').textContent = `Showing 1–${rows.length} of 120`;
    }

    renderRows(demoRows);

    // --- Toolbar wiring (lightweight stubs) --------------------------------
    document.getElementById('btnRefresh').addEventListener('click', ()=> renderRows(demoRows));
    document.getElementById('btnFilter').addEventListener('click', ()=>{
      alert('Open filter panel (stub)');
    });
    document.getElementById('btnExport').addEventListener('click', ()=>{
      // Simple CSV export of current table
      const header = ['Reference','Number','Branch','Customer','Status','Source','Total(KWD)','Business Date','Opened At'];
      const lines = [header.join(',')].concat(
        demoRows.map(r => [
          r.ref, r.num, r.branch, r.customer.replace(/<br>/g,' '), r.status, r.source, r.kwd, r.bdate, r.opened
        ].map(x=>`"${String(x).replace(/"/g,'""')}"`).join(','))
      );
      const blob = new Blob([lines.join('\n')],{type:'text/csv;charset=utf-8;'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a'); a.href = url; a.download = 'orders.csv';
      document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
    });

    // Tabs (visual only for now)
    document.querySelectorAll('.orders-tabs .nav-link').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        document.querySelectorAll('.orders-tabs .nav-link').forEach(b=>b.classList.remove('active'));
        btn.classList.add('active');
        // In a real app, filter data here by btn.dataset.tab
      });
    });

    // Pagination stubs
    document.getElementById('prevPage').addEventListener('click', ()=> alert('Prev page (stub)'));
    document.getElementById('nextPage').addEventListener('click', ()=> alert('Next page (stub)'));
  })();
  </script>
    </body>
</html>