<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8"/>
        <meta name="viewport" content="width=device-width,initial-scale=1"/>
        <title>Orders · Loyalty Console</title>
        <!-- Fonts + Bootstrap + Icons -->
        <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
        <!-- Your site styles -->
        <link href="css/style.css" rel="stylesheet">
    </head>
    <body>
        <div class="layout">
            <!-- Sidebar (central include) -->
            <aside class="sidebar" data-include="sidebar.html"></aside>
            <!-- Main -->
            <div class="main">
                <!-- Topbar (kept minimal title area; user chip shows at right) -->
                <header class="dt-topbar">
                    <div class="tb-inner container d-flex align-items-center justify-content-between">
                        <div class="d-flex align-items-center gap-2">
                            <!-- Mobile menu -->
                            <button class="btn-icon burger" id="burger" aria-label="Toggle menu">☰</button>
                            <!-- Collapse sidebar -->
                            <button class="btn-icon" id="collapseBtn" aria-label="Collapse sidebar"><i class="fa-solid fa-bars"></i>
                            </button>
                        </div>
                        <div class="flex-grow-1"></div>
                        <!-- Profile chip injected by js/app-user.js -->
                        <div class="userchip-wrap"></div>
                    </div>
                </header>
                <!-- Page -->
                <main class="page">
                    <div class="container-narrow">
                        <!-- Title + actions -->
                        <div class="d-flex align-items-center justify-content-between mb-2">
                            <div>
                                <h1 class="h5 fw-bold mb-0">Orders</h1>
                                <div class="text-muted small">Recent orders and payment methods</div>
                            </div>
                            <div class="d-flex gap-2">
                                <button class="btn btn-outline-secondary btn-sm">
                                    <i class="fa-solid fa-download me-1"></i>Export CSV
                                </button><a class="btn btn-primary btn-sm" href="reports.html"><i class="fa-solid fa-chart-simple me-1"></i>Open Reports</a>
                            </div>
                        </div>
                        <!-- Filters row -->
                        <div class="row g-2 mb-2">
                            <div class="col-12 col-md-3">
                                <select class="form-select">
                                    <option selected>Last 30 days</option>
                                    <option>Last 7 days</option>
                                    <option>Today</option>
                                </select>
                            </div>
                            <div class="col-12 col-md-3">
                                <select class="form-select" id="payFilter">
                                    <option value="">All payment types</option>
                                    <option value="Knet">Knet</option>
                                    <option value="Apple Pay">Apple Pay</option>
                                    <option value="Loyalty">Loyalty</option>
                                    <option value="Cash">Cash</option>
                                    <option value="Card">Card</option>
                                </select>
                            </div>
                            <div class="col-12 col-md-4">
                                <input class="form-control" id="q" placeholder="Search by customer or #order…">
                            </div>
                            <div class="col-12 col-md-2 d-grid">
                                <button class="btn btn-outline-secondary" id="btnReset">Reset</button>
                            </div>
                        </div>
                        <!-- Table -->
                        <div class="dt-card p-card">
                            <div class="table-responsive">
                                <table class="table align-middle mb-0">
                                    <thead>
                                        <tr>
                                            <th style="width:120px">Order</th>
                                            <th>Customer</th>
                                            <th>When</th>
                                            <th>Payment</th>
                                            <th class="text-end">Amount</th>
                                        </tr>
                                    </thead>
                                    <tbody id="ordBody">
                                        <!-- rows injected -->
                                    </tbody>
                                </table>
                            </div>
                            <!-- Footer: pagination -->
                            <div class="d-flex align-items-center justify-content-between pt-2 mt-2 border-top">
                                <div class="small text-muted" id="rowsInfo">Showing 0 of 0</div>
                                <div class="btn-group">
                                    <button class="btn btn-outline-secondary btn-sm" id="prev">Previous</button>
                                    <button class="btn btn-outline-secondary btn-sm" id="next">Next</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </main>
            </div>
        </div>
        <!-- Scripts (order matters) -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
        <script src="js/dt-include.js"></script>
        <script src="js/sidebar.js" defer></script>
        <script src="js/app-user.js" defer></script>
        <!-- Page logic -->
        <script>
    (function () {
      // Demo data (extend freely)
      const ALL = [
        { id:1770355, cust:'Mark Christopher', when:'Aug 16, 08:05', pay:'Knet',      amount:1.400 },
        { id:1770220, cust:'Reem',             when:'Aug 16, 07:51', pay:'Apple Pay', amount:3.780 },
        { id:1769988, cust:'Ali',              when:'Aug 15, 23:10', pay:'Loyalty',   amount:2.600 },
        { id:1769901, cust:'Sara',             when:'Aug 15, 21:03', pay:'Cash',      amount:1.950 },
        { id:1769810, cust:'Mo',               when:'Aug 15, 19:40', pay:'Card',      amount:4.200 },
      ];

      // Simple paging
      let page = 0, perPage = 10;

      const elBody = document.getElementById('ordBody');
      const payFilter = document.getElementById('payFilter');
      const q = document.getElementById('q');
      const info = document.getElementById('rowsInfo');

      function filtered() {
        const f = (payFilter.value||'').trim().toLowerCase();
        const s = (q.value||'').trim().toLowerCase();
        return ALL.filter(r => {
          const okPay = !f || (r.pay||'').toLowerCase() === f;
          const okSearch =
            !s ||
            String(r.id).includes(s) ||
            (r.cust||'').toLowerCase().includes(s);
          return okPay && okSearch;
        });
      }

      function render() {
        const rows = filtered();
        const start = page * perPage;
        const slice = rows.slice(start, start + perPage);

        elBody.innerHTML = slice.map(r => `
          <tr>
            <td><a href="order-details.html?id=${r.id}">#${r.id}</a></td>
            <td>${r.cust || '-'}</td>
            <td>${r.when}</td>
            <td>${r.pay}</td>
            <td class="text-end">KWD ${r.amount.toFixed(3)}</td>
          </tr>
        `).join('');

        info.textContent = `Showing ${slice.length} of ${rows.length}`;
        document.getElementById('prev').disabled = (page === 0);
        document.getElementById('next').disabled = (start + perPage >= rows.length);
      }

      // Events
      payFilter.addEventListener('change', () => { page = 0; render(); });
      q.addEventListener('input', () => { page = 0; render(); });
      document.getElementById('btnReset').addEventListener('click', () => {
        payFilter.value = ''; q.value = ''; page = 0; render();
      });
      document.getElementById('prev').addEventListener('click', () => { page = Math.max(0, page - 1); render(); });
      document.getElementById('next').addEventListener('click', () => { page = page + 1; render(); });

      // Initial draw
      render();
    })();
  </script>
    </body>
</html>