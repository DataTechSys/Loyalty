<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8"/>
        <meta name="viewport" content="width=device-width,initial-scale=1"/>
        <title>Settings Â· Loyalty Console</title>
        <!-- Fonts + Bootstrap + Icons -->
        <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
        <!-- Favicon + App styles -->
        <link rel="icon" type="image/x-icon" href="images/datatech-ico.ico">
        <link rel="stylesheet" href="css/style.css">
        <link rel="stylesheet" href="css/sidebar.css">
    </head>
    <body>
        <div class="layout">
            <!-- Sidebar include -->
            <aside class="sidebar" id="sidebar" data-include="partials/sidebar.html"></aside>
            <!-- Main -->
            <div class="main">
                <!-- Topbar include -->
                <div data-include="partials/topbar.html"></div>
                <!-- Page -->
                <main class="page">
                    <div class="container-narrow">
                        <!-- Title -->
                        <div class="d-flex align-items-center justify-content-between mb-2">
                            <div>
                                <h1 class="h5 fw-bold mb-0">Settings</h1>
                                <div class="text-muted small">Manage your account and application configuration</div>
                            </div>
                        </div>
                        <!-- General Settings -->
                        <section class="mb-3">
                            <div class="dt-card p-card">
                                <div class="d-flex align-items-center justify-content-between mb-2">
                                    <h2 class="h6 mb-0">General</h2>
                                </div>
                                <div class="row g-2">
                                    <div class="col-12 col-md-6 col-lg-4"><a class="btn btn-outline-secondary w-100 d-flex align-items-center justify-content-between" href="profile.html"> <span><i class="fa-regular fa-user me-2"></i> Profile</span> <i class="fa-solid fa-chevron-right"></i> </a>
                                    </div>
                                    <div class="col-12 col-md-6 col-lg-4"><a class="btn btn-outline-secondary w-100 d-flex align-items-center justify-content-between" href="reports.html"> <span><i class="fa-solid fa-chart-line me-2"></i> Reports Preferences</span> <i class="fa-solid fa-chevron-right"></i> </a>
                                    </div>
                                </div>
                            </div>
                        </section>
                        <!-- Admin (role-gated) -->
                        <section id="adminSection" class="mb-3" style="display:none;">
                            <div class="dt-card p-card">
                                <div class="d-flex align-items-center justify-content-between mb-2">
                                    <h2 class="h6 mb-0">Admin</h2><span class="badge text-bg-secondary">Role required</span>
                                </div>
                                <div class="row g-2">
                                    <div class="col-12 col-md-6 col-lg-4"><a class="btn btn-outline-secondary w-100 d-flex align-items-center justify-content-between" href="admin-users.html"> <span><i class="fa-solid fa-people-group me-2"></i> Users</span> <i class="fa-solid fa-chevron-right"></i> </a>
                                    </div>
                                    <div class="col-12 col-md-6 col-lg-4"><a class="btn btn-outline-secondary w-100 d-flex align-items-center justify-content-between" href="admin-rolls.html"> <span><i class="fa-solid fa-id-card-clip me-2"></i> Roles</span> <i class="fa-solid fa-chevron-right"></i> </a>
                                    </div>
                                    <div class="col-12 col-md-6 col-lg-4"><a class="btn btn-outline-secondary w-100 d-flex align-items-center justify-content-between" href="admin-loyalty.html"> <span><i class="fa-solid fa-gift me-2"></i> Loyalty</span> <i class="fa-solid fa-chevron-right"></i> </a>
                                    </div>
                                </div>
                            </div>
                        </section>
                        <!-- Super Admin (role-gated) -->
                        <section id="superAdminSection" class="mb-3" style="display:none;">
                            <div class="dt-card p-card">
                                <div class="d-flex align-items-center justify-content-between mb-2">
                                    <h2 class="h6 mb-0">Super Admin</h2><span class="badge text-bg-secondary">Role required</span>
                                </div>
                                <div class="row g-2">
                                    <div class="col-12 col-md-6 col-lg-4"><a class="btn btn-outline-secondary w-100 d-flex align-items-center justify-content-between" href="super-admin.html#api"> <span><i class="fa-solid fa-key me-2"></i> API Tokens</span> <i class="fa-solid fa-chevron-right"></i> </a>
                                    </div>
                                    <div class="col-12 col-md-6 col-lg-4"><a class="btn btn-outline-secondary w-100 d-flex align-items-center justify-content-between" href="super-admin.html#integrations"> <span><i class="fa-solid fa-plug me-2"></i> Integrations</span> <i class="fa-solid fa-chevron-right"></i> </a>
                                    </div>
                                </div>
                            </div>
                        </section>
                    </div>
                </main>
            </div>
        </div>
        <!-- JS -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
        <script src="js/dt-include.js"></script>
        <script src="js/sidebar.js" defer></script>
        <script src="js/app-user.js" defer></script>
        <script>
      (function(){
        // Require login
        try{
          if (window.UserSession && !window.UserSession.isAuthenticated()){
            sessionStorage.setItem('redirectAfterLogin','settings.html');
            location.replace('login.html'); return;
          }
        }catch(_){}

        // Role gating
        const session = (window.UserSession && window.UserSession.get && window.UserSession.get()) || {};
        const role = (session.user && (session.user.role || session.user.roles && session.user.roles[0])) || 'user';

        // Simple permission checks:
        function can(section){
          // owner has all
          if (role === 'owner') return true;
          if (section === 'admin')      return role === 'admin' || role === 'superadmin';
          if (section === 'superadmin') return role === 'superadmin';
          return false;
        }

        const adminEl = document.getElementById('adminSection');
        const superEl = document.getElementById('superAdminSection');

        if (can('admin'))      adminEl.style.display = '';
        if (can('superadmin')) superEl.style.display = '';
      })();
    </script>
    </body>
</html>