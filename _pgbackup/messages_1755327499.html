<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8"/>
        <meta name="viewport" content="width=device-width,initial-scale=1"/>
        <title>Messages · Loyalty Console</title>
        <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
        <link href="css/style.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
    </head>
    <body>
        <div class="layout">
            <aside class="sidebar" id="sidebar">
                <div class="sb-brand">
                    <img src="images/DataTech.png" alt="DataTech">
                    <span class="brand-text">Loyalty Console</span>
                </div>
                <nav class="sb-nav"><a class="sb-link" href="dashboard.html"><i class="fa-solid fa-gauge-high"></i><span class="sb-text">Dashboard</span></a><a class="sb-link" href="orders.html"><i class="fa-solid fa-cart-shopping"></i><span class="sb-text">Orders</span></a><a class="sb-link" href="members.html"><i class="fa-solid fa-users"></i><span class="sb-text">Customers</span></a><a class="sb-link active" href="messages.html"><i class="fa-solid fa-paper-plane"></i><span class="sb-text">Messages</span></a><a class="sb-link" href="reports.html"><i class="fa-solid fa-chart-line"></i><span class="sb-text">Reports</span></a><a class="sb-link" href="settings.html"><i class="fa-solid fa-gear"></i><span class="sb-text">Settings</span></a><a class="sb-link" href="admin.html"><i class="fa-solid fa-user-shield"></i><span class="sb-text">Admin</span></a><a class="sb-link" href="login.html"><i class="fa-solid fa-right-to-bracket"></i><span class="sb-text">Login</span></a>
                </nav>
                <div class="sb-footer">© DataTech 2025</div>
            </aside>
            <div class="main">
                <header class="dt-topbar">
                    <div class="tb-inner container d-flex align-items-center justify-content-between">
                        <div class="d-flex align-items-center gap-2">
                            <button class="btn-icon burger" id="burger" aria-label="Toggle menu">☰</button>
                            <button class="btn-icon" id="collapseBtn" aria-label="Collapse sidebar">
                                <i class="fa-solid fa-bars"></i>
                            </button>
                        </div>
                        <div></div>
                        <div class="userchip-wrap"></div>
                    </div>
                </header>
                <main class="page">
                    <div class="container-narrow">
                        <div class="d-flex align-items-center justify-content-between mb-2">
                            <div>
                                <h1 class="h5 fw-bold mb-0">Messages</h1>
                                <div class="text-muted small">Send push / wallet passes to your customers</div>
                            </div>
                            <div class="d-flex gap-2">
                                <button type="button" class="btn btn-primary btn-sm">
                                    <i class="fa-solid fa-plus me-1"></i>Create campaign
                                </button>
                            </div>
                        </div>
                        <div class="row g-2">
                            <div class="col-12 col-lg-7">
                                <div class="dt-card p-card h-100">
                                    <div class="d-flex align-items-center justify-content-between mb-1">
                                        <h2 class="h6 mb-0">Campaigns</h2><a href="#" class="small">See all</a>
                                    </div>
                                    <div class="table-responsive">
                                        <table class="table align-middle mb-0">
                                            <thead>
                                                <tr>
                                                    <th>Name</th>
                                                    <th>Segment</th>
                                                    <th>Channel</th>
                                                    <th class="text-end">Sent</th>
                                                </tr>
                                            </thead>
                                            <tbody id="cmpBody"></tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                            <div class="col-12 col-lg-5">
                                <div class="dt-card p-card h-100">
                                    <h2 class="h6 mb-1">Quick message</h2>
                                    <form id="msgForm" class="row g-2">
                                        <div class="col-12">
                                            <label class="form-label small">Audience</label>
                                            <select class="form-select" id="aud">
                                                <option value="all">All customers</option>
                                                <option value="recent">Bought in last 30 days</option>
                                                <option value="noorders">No orders in 60 days</option>
                                            </select>
                                        </div>
                                        <div class="col-12">
                                            <label class="form-label small">Message</label>
                                            <textarea class="form-control" id="txt" rows="4" placeholder="Write your message…"></textarea>
                                        </div>
                                        <div class="col-12 d-grid">
                                            <button class="btn btn-primary" type="submit">
                                                <i class="fa-solid fa-paper-plane me-1"></i>Send
                                            </button>
                                        </div>
                                        <div class="alert alert-success d-none" id="sentOk">Message queued (demo).</div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </main>
            </div>
        </div>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
        <script src="js/app-user.js"></script>
        <script>
(function(){
  try{
    if (window.UserSession && !window.UserSession.isAuthenticated()){
      sessionStorage.setItem('redirectAfterLogin','messages.html');
      location.replace('login.html'); return;
    }
  }catch(_){}

  const sidebar = document.getElementById('sidebar');
  document.getElementById('burger')?.addEventListener('click',()=> sidebar.classList.toggle('open'));
  document.getElementById('collapseBtn')?.addEventListener('click',()=> sidebar.classList.toggle('collapsed'));
  sidebar.querySelectorAll('a.sb-link').forEach(a=>a.addEventListener('click',()=> sidebar.classList.remove('open')));

  // demo campaigns
  const campaigns = [
    {name:'Weekend Promo', seg:'All', ch:'Push', sent:'3,140'},
    {name:'Wallet Pass Update', seg:'Members', ch:'Wallet', sent:'1,020'},
    {name:'We miss you', seg:'No orders 60d', ch:'Push', sent:'540'},
  ];
  document.getElementById('cmpBody').innerHTML = campaigns.map(c=>`
    <tr><td class="fw-semibold">${c.name}</td><td>${c.seg}</td><td>${c.ch}</td><td class="text-end">${c.sent}</td></tr>
  `).join('');

  document.getElementById('msgForm').addEventListener('submit', (e)=>{
    e.preventDefault();
    document.getElementById('sentOk').classList.remove('d-none');
    setTimeout(()=>document.getElementById('sentOk').classList.add('d-none'), 1500);
    e.target.reset();
  });
})();
</script>
    </body>
</html>