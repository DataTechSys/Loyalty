<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8"/>
        <meta name="viewport" content="width=device-width, initial-scale=1"/>
        <title>Order Details · Loyalty Console</title>
        <!-- Fonts / Bootstrap -->
        <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
        <!-- App theme -->
        <link href="css/style.css" rel="stylesheet"/>
        <style>
    /* Page-specific polish */
    .od-head{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:12px}
    .od-back{display:inline-flex;align-items:center;gap:8px;color:#111;text-decoration:none;font-weight:600}
    .od-badge{border:1px solid var(--dt-border);background:#fff;border-radius:999px;padding:.25rem .6rem;font-weight:700}
    .od-card{background:var(--dt-card);border:1px solid var(--dt-border);border-radius:16px;box-shadow:var(--dt-shadow);padding:14px}
    .od-grid{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    .od-field{border-top:1px solid var(--dt-border);padding:10px 6px 6px}
    .od-field:first-child,.od-field:nth-child(2){border-top:0}
    .od-label{color:var(--dt-muted);font-size:.8rem;margin-bottom:2px}
    .od-value{font-weight:600}
    .od-section-title{font-weight:700;margin:18px 0 8px}
    .tag-pill{display:inline-flex;align-items:center;border:1px solid var(--dt-border);border-radius:999px;padding:.35rem .6rem;background:#fff;margin-right:6px}
    .print-btn{border:1px solid var(--dt-border)}
    @media (max-width: 767.98px){ .od-grid{grid-template-columns:1fr} }
    /* Highlight Orders in the side menu */
    .sb-nav a[href="orders.html"].sb-link { background:#23314a; color:#fff; }
  </style>
    </head>
    <body>
        <div class="layout">
            <!-- Sidebar (standard, no “Order Details” item) -->
            <aside class="sidebar" id="sidebar">
                <div class="sb-brand">
                    <img src="images/DataTech.png" alt="DataTech"><span class="brand-text">Loyalty Console</span>
                </div>
                <nav class="sb-nav"><a class="sb-link" href="dashboard.html"><i class="fa-solid fa-gauge-high"></i><span class="sb-text">Dashboard</span></a><a class="sb-link" href="orders.html"><i class="fa-solid fa-cart-shopping"></i><span class="sb-text">Orders</span></a><a class="sb-link" href="members.html"><i class="fa-solid fa-users"></i><span class="sb-text">Customers</span></a><a class="sb-link" href="messages.html"><i class="fa-solid fa-paper-plane"></i><span class="sb-text">Messages</span></a><a class="sb-link" href="reports.html"><i class="fa-solid fa-chart-line"></i><span class="sb-text">Reports</span></a><a class="sb-link" href="settings.html"><i class="fa-solid fa-gear"></i><span class="sb-text">Settings</span></a><a class="sb-link" href="admin.html"><i class="fa-solid fa-user-shield"></i><span class="sb-text">Admin</span></a><a class="sb-link" href="login.html"><i class="fa-solid fa-right-to-bracket"></i><span class="sb-text">Login</span></a>
                </nav>
                <div class="sb-footer">© DataTech 2025</div>
            </aside>
            <!-- Main -->
            <div class="main">
                <!-- Topbar (no centered title; profile chip on right via app-user.js) -->
                <header class="dt-topbar">
                    <div class="tb-inner container d-flex align-items-center justify-content-between">
                        <div class="d-flex align-items-center gap-2">
                            <button class="btn-icon burger" id="burger" aria-label="Toggle menu">☰</button>
                            <button class="btn-icon" id="collapseBtn" aria-label="Collapse sidebar">
                                <i class="fa-solid fa-bars"></i>
                            </button>
                        </div>
                        <div></div>
                        <div class="d-flex align-items-center gap-2">
                            <!-- user chip injected by js/app-user.js -->
                        </div>
                    </div>
                </header>
                <!-- Page -->
                <main class="page">
                    <div class="container-narrow">
                        <!-- Back + title + status + print -->
                        <div class="od-head">
                            <div class="d-flex align-items-center gap-3"><a href="orders.html" class="od-back">‹ Back</a>
                                <h1 class="h5 mb-0">Order <span id="odRef">(—)</span></h1><span class="od-badge" id="odStatus">Done</span>
                            </div>
                            <button class="btn btn-sm btn-outline-secondary print-btn" id="btnPrint">Print</button>
                        </div>
                        <!-- Info -->
                        <div class="od-card mb-2">
                            <div class="od-grid">
                                <div class="od-field">
                                    <div class="od-label">Business Date</div>
                                    <div class="od-value" id="businessDate">—</div>
                                </div>
                                <div class="od-field">
                                    <div class="od-label">Number</div>
                                    <div class="od-value" id="orderNumber">—</div>
                                </div>
                                <div class="od-field">
                                    <div class="od-label">Type</div>
                                    <div class="od-value" id="type">—</div>
                                </div>
                                <div class="od-field">
                                    <div class="od-label">Source</div>
                                    <div class="od-value" id="source">—</div>
                                </div>
                                <div class="od-field">
                                    <div class="od-label">Branch</div>
                                    <div class="od-value" id="branch">—</div>
                                </div>
                                <div class="od-field">
                                    <div class="od-label">Opened At</div>
                                    <div class="od-value" id="openedAt">—</div>
                                </div>
                                <div class="od-field">
                                    <div class="od-label">Due At</div>
                                    <div class="od-value" id="dueAt">-</div>
                                </div>
                                <div class="od-field">
                                    <div class="od-label">Closed At</div>
                                    <div class="od-value" id="closedAt">—</div>
                                </div>
                                <div class="od-field">
                                    <div class="od-label">Guests</div>
                                    <div class="od-value" id="guests">—</div>
                                </div>
                                <div class="od-field">
                                    <div class="od-label">Created By</div>
                                    <div class="od-value" id="createdBy">—</div>
                                </div>
                                <div class="od-field">
                                    <div class="od-label">Closed By</div>
                                    <div class="od-value" id="closedBy">—</div>
                                </div>
                                <div class="od-field">
                                    <div class="od-label">Customer</div>
                                    <div class="od-value" id="customer">—</div>
                                </div>
                                <div class="od-field">
                                    <div class="od-label">Check Number</div>
                                    <div class="od-value" id="checkNumber">—</div>
                                </div>
                                <div class="od-field">
                                    <div class="od-label">Retrieval Reference</div>
                                    <div class="od-value" id="retrievalRef">—</div>
                                </div>
                            </div>
                        </div>
                        <!-- Totals -->
                        <div class="od-card mb-2">
                            <div class="od-grid">
                                <div class="od-field">
                                    <div class="od-label">Sub Total</div>
                                    <div class="od-value" id="subTotal">—</div>
                                </div>
                                <div class="od-field">
                                    <div class="od-label">Discount</div>
                                    <div class="od-value" id="discount">—</div>
                                </div>
                                <div class="od-field">
                                    <div class="od-label">Total Charges</div>
                                    <div class="od-value" id="totalCharges">—</div>
                                </div>
                                <div class="od-field">
                                    <div class="od-label">Total Taxes</div>
                                    <div class="od-value" id="totalTaxes">—</div>
                                </div>
                                <div class="od-field">
                                    <div class="od-label">Rounding Amount</div>
                                    <div class="od-value" id="rounding">—</div>
                                </div>
                                <div class="od-field">
                                    <div class="od-label">Final Price</div>
                                    <div class="od-value" id="finalPrice">—</div>
                                </div>
                            </div>
                        </div>
                        <!-- Tags -->
                        <h2 class="od-section-title">Tags</h2>
                        <div class="od-card mb-2 d-flex align-items-center justify-content-between">
                            <div id="tagsWrap"></div>
                            <button class="btn btn-sm btn-outline-secondary">Edit Tags</button>
                        </div>
                        <!-- Products -->
                        <h2 class="od-section-title">Products</h2>
                        <div class="od-card mb-2">
                            <div class="table-responsive">
                                <table class="table align-middle mb-0">
                                    <thead>
                                        <tr>
                                            <th style="width:80px">Quantity</th>
                                            <th>Item</th>
                                            <th class="text-end" style="width:140px">Unit Price</th>
                                            <th class="text-end" style="width:120px">Discount</th>
                                            <th class="text-end" style="width:120px">Notes</th>
                                            <th class="text-end" style="width:140px">Total Price</th>
                                        </tr>
                                    </thead>
                                    <tbody id="productsBody"></tbody>
                                </table>
                            </div>
                        </div>
                        <!-- Payments -->
                        <h2 class="od-section-title">Payments</h2>
                        <div class="od-card">
                            <div class="table-responsive">
                                <table class="table align-middle mb-0">
                                    <thead>
                                        <tr>
                                            <th>Name</th>
                                            <th class="text-end">Amount</th>
                                            <th class="text-end">Added</th>
                                            <th class="text-end">Retrieval Reference Number</th>
                                        </tr>
                                    </thead>
                                    <tbody id="paymentsBody"></tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </main>
            </div>
        </div>
        <!-- Icons (Font Awesome) -->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
        <!-- Bootstrap -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
        <!-- Profile dropdown + guard -->
        <script src="js/app-user.js"></script>
        <script>
    // Sidebar toggles
    (function(){
      const sidebar=document.getElementById('sidebar');
      document.getElementById('burger')?.addEventListener('click',()=>sidebar.classList.toggle('open'));
      document.getElementById('collapseBtn')?.addEventListener('click',()=>sidebar.classList.toggle('collapsed'));
      sidebar.querySelectorAll('a.sb-link').forEach(a=>a.addEventListener('click',()=>sidebar.classList.remove('open')));
    })();

    // Demo order data (same as your screenshots)
    const ORDER = {
      id: "1770355",
      status: "Done",
      businessDate: "2025-08-16",
      number: "19",
      type: "Drive Thru",
      source: "Cashier",
      branch: "AHB | Abu Halifa",
      openedAt: "August 16, 08:04am",
      closedAt: "August 16, 08:05am",
      dueAt: "-",
      guests: 1,
      createdBy: "285 | Mark Christopher",
      closedBy: "285 | Mark Christopher",
      customer: "-",
      checkNumber: "477789",
      retrievalRef: "—",
      totals: { subTotal: 1.4, discount: 0, totalCharges: 0, totalTaxes: 0, rounding: 0, finalPrice: 1.4 },
      tags: ["No | Koobs Membership"],
      products: [
        { qty:1, name:"ICED | Americano (M)",
          modifiers:["1 Espresso | Colombia - (KWD 0)","White Mocha Sauce - (KWD 0.2)"],
          unit:1.2, discount:"-", notes:"-", total:1.4 }
      ],
      payments: [ { name:"Knet", amount:1.4, added:"August 16, 08:05am", retrieval:"—" } ]
    };

    const fmtKWD = v => `KWD ${Number(v).toFixed(1)}`;

    (function render(){
      const d = ORDER; // replace with fetch by ?id= later if needed
      document.getElementById('odRef').textContent = `(${d.id})`;
      document.getElementById('odStatus').textContent = d.status;

      // Info
      const map = {
        businessDate:'businessDate', orderNumber:'number', type:'type', source:'source',
        branch:'branch', openedAt:'openedAt', dueAt:'dueAt', closedAt:'closedAt',
        guests:'guests', createdBy:'createdBy', closedBy:'closedBy', customer:'customer',
        checkNumber:'checkNumber', retrievalRef:'retrievalRef'
      };
      Object.entries(map).forEach(([el,key])=>{
        const node = document.getElementById(el);
        if(node) node.textContent = d[key];
      });

      // Totals
      document.getElementById('subTotal').textContent   = fmtKWD(d.totals.subTotal);
      document.getElementById('discount').textContent   = d.totals.discount===0 ? '-' : fmtKWD(d.totals.discount);
      document.getElementById('totalCharges').textContent = d.totals.totalCharges===0 ? 'KWD 0' : fmtKWD(d.totals.totalCharges);
      document.getElementById('totalTaxes').textContent = d.totals.totalTaxes===0 ? 'KWD 0' : fmtKWD(d.totals.totalTaxes);
      document.getElementById('rounding').textContent   = d.totals.rounding===0 ? 'KWD 0' : fmtKWD(d.totals.rounding);
      document.getElementById('finalPrice').textContent = fmtKWD(d.totals.finalPrice);

      // Tags
      document.getElementById('tagsWrap').innerHTML =
        d.tags.map(t => `<span class="tag-pill">${t}</span>`).join('');

      // Products
      document.getElementById('productsBody').innerHTML =
        d.products.map(p => `
          <tr>
            <td>${p.qty}</td>
            <td>
              <div class="fw-semibold">${p.name}</div>
              ${p.modifiers?.length ? `<div class="text-muted small">${p.modifiers.join(' · ')}</div>`:''}
            </td>
            <td class="text-end">${fmtKWD(p.unit)}</td>
            <td class="text-end">${p.discount}</td>
            <td class="text-end">${p.notes}</td>
            <td class="text-end">${fmtKWD(p.total)}</td>
          </tr>
        `).join('');

      // Payments
      document.getElementById('paymentsBody').innerHTML =
        d.payments.map(pm => `
          <tr>
            <td>${pm.name}</td>
            <td class="text-end">${fmtKWD(pm.amount)}</td>
            <td class="text-end">${pm.added}</td>
            <td class="text-end">${pm.retrieval}</td>
          </tr>
        `).join('');
    })();

    // Print
    document.getElementById('btnPrint').addEventListener('click', ()=>window.print());
  </script>
    </body>
</html>