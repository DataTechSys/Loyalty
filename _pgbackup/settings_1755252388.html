<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8"/>
        <meta name="viewport" content="width=device-width,initial-scale=1"/>
        <title>Settings · Loyalty Console</title>
        <!-- Inter + Bootstrap -->
        <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
        <!-- Font Awesome (icons for the sidebar) -->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
        <style>
    :root{
      --dt-bg:#f3f5f9; --dt-card:#ffffff; --dt-text:#0f172a; --dt-muted:#6b7280;
      --dt-primary:#1f6feb; --dt-border:#e5e7eb; --dt-radius-lg:16px; --dt-shadow:0 8px 24px rgba(15,23,42,.06);
      --hover:#fafbff; --maxw:1180px; --sidebar-w:240px;
    }
    html,body{height:100%}
    body{ margin:0; background:var(--dt-bg); color:var(--dt-text); font-family:'Inter',system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; }

    /* Layout */
    .layout{ display:flex; min-height:100vh; }
    .sidebar{
      width:var(--sidebar-w); background:#111827; color:#e5e7eb; position:sticky; top:0; align-self:flex-start;
      height:100vh; border-right:1px solid #0b1220; display:flex; flex-direction:column;
    }
    .sb-brand{
      display:flex; align-items:center; gap:.6rem; padding:14px 14px; border-bottom:1px solid rgba(255,255,255,.06); font-weight:700;
    }
    .sb-brand img{ width:22px; height:22px; border-radius:6px; }
    .sb-nav{ padding:10px 8px; display:flex; flex-direction:column; gap:4px; }
    .sb-link{
      display:flex; align-items:center; gap:12px; padding:10px 12px; border-radius:10px; color:#e5e7eb; text-decoration:none; font-weight:600; font-size:.95rem;
    }
    .sb-link:hover{ background:#1f2937; }
    .sb-link.active{ background:#23314a; color:#fff; }
    .sb-link i{ width:22px; min-width:22px; text-align:center; font-size:15px; opacity:.95; }
    .sb-footer{ margin-top:auto; padding:12px; font-size:.8rem; color:#9ca3af; border-top:1px solid rgba(255,255,255,.06); }

    .main{ flex:1; min-width:0; display:flex; flex-direction:column; }
    .dt-topbar{ background:var(--dt-card); border-bottom:1px solid var(--dt-border); position:sticky; top:0; z-index:1030; }
    .tb-inner.container{ max-width:calc(var(--maxw) + 32px); padding:8px 16px; }
    .dt-brand{ display:flex; align-items:center; gap:.65rem; font-weight:600; }
    .dt-brand img{ width:22px; height:22px; border-radius:6px; }

    .page{ flex:1; }
    .container-narrow{ max-width:var(--maxw); margin:0 auto; padding:18px 16px 28px; }

    /* Cards */
    .dt-card{ background:var(--dt-card); border:1px solid var(--dt-border); border-radius:var(--dt-radius-lg); box-shadow:var(--dt-shadow); }
    .p-card{ padding:16px; }
    @media (min-width:768px){ .p-card{ padding:18px; } }

    .form-control, .form-select, .btn{ border-radius:12px; }
    .btn-primary{
      --bs-btn-bg: var(--dt-primary); --bs-btn-border-color: var(--dt-primary);
      --bs-btn-hover-bg:#1b5ed1; --bs-btn-hover-border-color:#1b5ed1;
      --bs-btn-active-bg:#184fb3; --bs-btn-active-border-color:#184fb3;
    }

    /* Mobile sidebar */
    @media (max-width: 991.98px){
      .sidebar{ position:fixed; left:0; top:0; transform:translateX(-100%); transition:transform .2s ease; z-index:1040; }
      .sidebar.open{ transform:translateX(0); }
      .tb-inner.container{ padding-left:56px; padding-right:16px; }
      .burger{ display:inline-flex !important; }
    }
    .burger{ display:none; align-items:center; justify-content:center; width:36px; height:36px; border-radius:8px; border:1px solid var(--dt-border); background:#fff; }
  </style>
    </head>
    <body>
        <div class="layout">
            <!-- Sidebar with icons -->
            <aside class="sidebar" id="sidebar">
                <div class="sb-brand">
                    <img src="images/DataTech.png" alt="DataTech"><span>Loyalty Console</span>
                </div>
                <nav class="sb-nav"><a class="sb-link" href="dashboard.html"><i class="fa-solid fa-gauge-high"></i> Dashboard</a><a class="sb-link" href="orders.html"><i class="fa-solid fa-cart-shopping"></i> Orders</a><a class="sb-link" href="order-details.html?id=1765956"><i class="fa-solid fa-receipt"></i> Order Details</a><a class="sb-link" href="members.html"><i class="fa-solid fa-users"></i> Customers</a><a class="sb-link" href="messages.html"><i class="fa-solid fa-paper-plane"></i> Messages</a><a class="sb-link" href="reports.html"><i class="fa-solid fa-chart-line"></i> Reports</a><a class="sb-link active" href="settings.html"><i class="fa-solid fa-gear"></i> Settings</a><a class="sb-link" href="super-admin.html"><i class="fa-solid fa-user-shield"></i> Super Admin</a><a class="sb-link" href="admin-invite.html"><i class="fa-solid fa-envelope-open-text"></i> Admin Invite</a><a class="sb-link" href="login.html"><i class="fa-solid fa-right-to-bracket"></i> Login</a>
                </nav>
                <div class="sb-footer">© DataTech</div>
            </aside>
            <!-- Main -->
            <div class="main">
                <!-- Top bar -->
                <header class="dt-topbar">
                    <div class="tb-inner container d-flex align-items-center justify-content-between">
                        <button class="burger" id="burger" aria-label="Toggle menu">☰</button>
                        <div class="dt-brand">
                            <img src="images/DataTech.png" alt="DataTech"><span>Loyalty Console</span>
                        </div>
                        <div class="d-flex align-items-center gap-2">
                            <!-- user chip injected -->
                        </div>
                    </div>
                </header>
                <!-- Page -->
                <main class="page">
                    <div class="container-narrow">
                        <div class="d-flex align-items-center justify-content-between mb-2">
                            <div>
                                <h1 class="h5 fw-bold mb-0">Settings</h1>
                                <div class="text-muted small">Branding, users, and integrations</div>
                            </div>
                            <div>
                                <button class="btn btn-primary btn-sm" id="btnSaveAll">Save All</button>
                            </div>
                        </div>
                        <!-- Tabs -->
                        <ul class="nav nav-tabs mb-2" id="tabs" role="tablist">
                            <li class="nav-item" role="presentation">
                                <button class="nav-link active" id="tab-brand" data-bs-toggle="tab" data-bs-target="#pane-brand" type="button" role="tab">Branding</button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="tab-company" data-bs-toggle="tab" data-bs-target="#pane-company" type="button" role="tab">Company</button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="tab-users" data-bs-toggle="tab" data-bs-target="#pane-users" type="button" role="tab">Users & Roles</button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="tab-integrations" data-bs-toggle="tab" data-bs-target="#pane-integrations" type="button" role="tab">Integrations</button>
                            </li>
                        </ul>
                        <div class="tab-content">
                            <!-- Branding -->
                            <div class="tab-pane fade show active" id="pane-brand" role="tabpanel" aria-labelledby="tab-brand">
                                <div class="row g-2">
                                    <div class="col-12 col-lg-6">
                                        <div class="dt-card p-card">
                                            <h2 class="h6">Logo & Colors</h2>
                                            <div class="mt-2">
                                                <label class="form-label small">Logo</label>
                                                <input type="file" class="form-control" id="brandLogo" accept="image/*">
                                            </div>
                                            <div class="row g-2 mt-1">
                                                <div class="col-6">
                                                    <label class="form-label small">Primary Color</label>
                                                    <input type="color" class="form-control form-control-color" id="brandPrimary" value="#1f6feb">
                                                </div>
                                                <div class="col-6">
                                                    <label class="form-label small">Accent Color</label>
                                                    <input type="color" class="form-control form-control-color" id="brandAccent" value="#10b981">
                                                </div>
                                            </div>
                                            <div class="mt-2">
                                                <label class="form-label small">Brand Name</label>
                                                <input class="form-control" id="brandName" placeholder="Your Brand Ltd.">
                                            </div>
                                            <div class="mt-2 text-end">
                                                <button class="btn btn-primary btn-sm" id="btnSaveBrand">Save Branding</button>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-12 col-lg-6">
                                        <div class="dt-card p-card">
                                            <h2 class="h6">Preview</h2>
                                            <div class="border rounded p-3 text-center">
                                                <img id="brandPreviewLogo" src="images/DataTech.png" alt="Logo" style="max-height:60px">
                                                <div class="fs-5 fw-bold mt-2" id="brandPreviewName">DataTech</div>
                                                <div class="mt-2"><span class="badge" id="brandBadge" style="background:#1f6feb;color:#fff;">Primary</span><span class="badge" id="brandBadge2" style="background:#10b981;color:#fff;">Accent</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- Company -->
                            <div class="tab-pane fade" id="pane-company" role="tabpanel" aria-labelledby="tab-company">
                                <div class="dt-card p-card">
                                    <h2 class="h6">Company Profile</h2>
                                    <div class="row g-2 mt-1">
                                        <div class="col-12 col-md-6">
                                            <label class="form-label small">Company Name</label>
                                            <input class="form-control" id="companyName" placeholder="Company Ltd.">
                                        </div>
                                        <div class="col-12 col-md-6">
                                            <label class="form-label small">Account Number</label>
                                            <input class="form-control" id="companyAccount" placeholder="ACCT-00001">
                                        </div>
                                        <div class="col-12 col-md-6">
                                            <label class="form-label small">Email</label>
                                            <input type="email" class="form-control" id="companyEmail" placeholder="support@company.com">
                                        </div>
                                        <div class="col-12 col-md-6">
                                            <label class="form-label small">Phone</label>
                                            <input class="form-control" id="companyPhone" placeholder="+965 ...">
                                        </div>
                                        <div class="col-12">
                                            <label class="form-label small">Address</label>
                                            <input class="form-control" id="companyAddress" placeholder="Street, City, Country">
                                        </div>
                                    </div>
                                    <div class="mt-2 text-end">
                                        <button class="btn btn-primary btn-sm" id="btnSaveCompany">Save Company</button>
                                    </div>
                                </div>
                            </div>
                            <!-- Users & Roles -->
                            <div class="tab-pane fade" id="pane-users" role="tabpanel" aria-labelledby="tab-users">
                                <div class="row g-2">
                                    <div class="col-12 col-lg-6">
                                        <div class="dt-card p-card">
                                            <h2 class="h6">Invite User</h2>
                                            <div class="row g-2 mt-1">
                                                <div class="col-12 col-md-6">
                                                    <label class="form-label small">Full Name</label>
                                                    <input class="form-control" id="uName" placeholder="Full name">
                                                </div>
                                                <div class="col-12 col-md-6">
                                                    <label class="form-label small">Email</label>
                                                    <input type="email" class="form-control" id="uEmail" placeholder="user@example.com">
                                                </div>
                                                <div class="col-12 col-md-6">
                                                    <label class="form-label small">Role</label>
                                                    <select class="form-select" id="uRole">
                                                        <option value="admin">Admin</option>
                                                        <option value="manager">Manager</option>
                                                        <option value="agent">Agent</option>
                                                        <option value="viewer">Viewer</option>
                                                    </select>
                                                </div>
                                                <div class="col-12 col-md-6">
                                                    <label class="form-label small">Team</label>
                                                    <input class="form-control" id="uTeam" placeholder="Ops, Marketing, ...">
                                                </div>
                                            </div>
                                            <div class="mt-2 text-end">
                                                <button class="btn btn-primary btn-sm" id="btnInvite">Send Invite</button>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-12 col-lg-6">
                                        <div class="dt-card p-card">
                                            <h2 class="h6">Existing Users</h2>
                                            <div class="table-responsive">
                                                <table class="table align-middle mb-0">
                                                    <thead>
                                                        <tr>
                                                            <th>Name</th>
                                                            <th>Email</th>
                                                            <th>Role</th>
                                                            <th class="text-end">Actions</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody id="usersBody">
                                                        <!-- injected -->
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- Integrations -->
                            <div class="tab-pane fade" id="pane-integrations" role="tabpanel" aria-labelledby="tab-integrations">
                                <div class="row g-2">
                                    <!-- PassKit -->
                                    <div class="col-12 col-lg-4">
                                        <div class="dt-card p-card">
                                            <h2 class="h6">PassKit</h2>
                                            <div class="mb-2">
                                                <label class="form-label small">API Key</label>
                                                <input class="form-control" id="pkKey" placeholder="pk_live_...">
                                            </div>
                                            <div class="mb-2">
                                                <label class="form-label small">Program ID</label>
                                                <input class="form-control" id="pkProgram" placeholder="program_...">
                                            </div>
                                            <div class="text-end">
                                                <button class="btn btn-primary btn-sm" id="btnSavePK">Save</button>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- Foodics -->
                                    <div class="col-12 col-lg-4">
                                        <div class="dt-card p-card">
                                            <h2 class="h6">Foodics</h2>
                                            <div class="mb-2">
                                                <label class="form-label small">Client ID</label>
                                                <input class="form-control" id="fxClient" placeholder="client_id">
                                            </div>
                                            <div class="mb-2">
                                                <label class="form-label small">Client Secret</label>
                                                <input class="form-control" id="fxSecret" placeholder="client_secret">
                                            </div>
                                            <div class="text-end">
                                                <button class="btn btn-primary btn-sm" id="btnSaveFX">Save</button>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- Twilio -->
                                    <div class="col-12 col-lg-4">
                                        <div class="dt-card p-card">
                                            <h2 class="h6">Twilio</h2>
                                            <div class="mb-2">
                                                <label class="form-label small">Account SID</label>
                                                <input class="form-control" id="twSid" placeholder="ACxxxxxxxx">
                                            </div>
                                            <div class="mb-2">
                                                <label class="form-label small">Auth Token</label>
                                                <input class="form-control" id="twToken" placeholder="••••••••">
                                            </div>
                                            <div class="text-end">
                                                <button class="btn btn-primary btn-sm" id="btnSaveTW">Save</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>                         

                        <!-- /tab-content -->
                    </div>
                </main>
            </div>
        </div>
        <!-- Bootstrap -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
        <!-- User chip -->
        <script src="js/app-user.js"></script>
        <script>
    (function(){
      // Auth guard
      try{
        if (window.UserSession && !window.UserSession.isAuthenticated()){
          sessionStorage.setItem('redirectAfterLogin','settings.html');
          location.replace('login.html'); return;
        }
      }catch(_){}

      // Mobile sidebar toggle
      const sidebar = document.getElementById('sidebar');
      const burger  = document.getElementById('burger');
      burger?.addEventListener('click', ()=> sidebar.classList.toggle('open'));
      sidebar.querySelectorAll('a.sb-link').forEach(a => a.addEventListener('click', ()=> sidebar.classList.remove('open')));

      // Demo: Users table
      const USERS = [
        { name:'Hussain Al‑Musawi', email:'hussain@example.com', role:'Admin' },
        { name:'Reem',              email:'reem@example.com',    role:'Manager' },
        { name:'Ali',               email:'ali@example.com',     role:'Agent' },
      ];
      const usersBody = document.getElementById('usersBody');
      function renderUsers(){
        usersBody.innerHTML = USERS.map((u,i)=>`
          <tr>
            <td class="fw-semibold">${u.name}</td>
            <td>${u.email}</td>
            <td>${u.role}</td>
            <td class="text-end">
              <div class="btn-group btn-group-sm">
                <button class="btn btn-outline-secondary" data-i="${i}" data-a="role">Change Role</button>
                <button class="btn btn-outline-secondary" data-i="${i}" data-a="remove">Remove</button>
              </div>
            </td>
          </tr>
        `).join('');
        usersBody.querySelectorAll('button').forEach(btn=>{
          btn.addEventListener('click', ()=>{
            const i = +btn.getAttribute('data-i');
            const a = btn.getAttribute('data-a');
            if (a==='remove'){
              USERS.splice(i,1); renderUsers();
            } else if (a==='role'){
              const newRole = prompt('New role (Admin/Manager/Agent/Viewer):', USERS[i].role);
              if (newRole) { USERS[i].role = newRole; renderUsers(); }
            }
          });
        });
      }
      renderUsers();

      // Branding live preview (demo)
      const brandName   = document.getElementById('brandName');
      const brandLogo   = document.getElementById('brandLogo');
      const previewName = document.getElementById('brandPreviewName');
      const previewLogo = document.getElementById('brandPreviewLogo');
      const brandPrimary= document.getElementById('brandPrimary');
      const brandAccent = document.getElementById('brandAccent');
      const brandBadge  = document.getElementById('brandBadge');
      const brandBadge2 = document.getElementById('brandBadge2');

      brandName.addEventListener('input', ()=> previewName.textContent = brandName.value || 'DataTech');
      brandLogo.addEventListener('change', (e)=>{
        const file = e.target.files?.[0]; if(!file) return;
        const reader = new FileReader();
        reader.onload = ev => { previewLogo.src = ev.target.result; };
        reader.readAsDataURL(file);
      });
      brandPrimary.addEventListener('input', ()=> brandBadge.style.background = brandPrimary.value);
      brandAccent.addEventListener('input', ()=> brandBadge2.style.background = brandAccent.value);

      // Save buttons (demo hooks)
      document.getElementById('btnSaveBrand').addEventListener('click', ()=> alert('Branding saved (demo).'));
      document.getElementById('btnSaveCompany').addEventListener('click', ()=> alert('Company saved (demo).'));
      document.getElementById('btnInvite').addEventListener('click', ()=>{
        const name = document.getElementById('uName').value.trim();
        const email= document.getElementById('uEmail').value.trim();
        const role = document.getElementById('uRole').value;
        if(!name || !email){ alert('Enter name & email'); return; }
        USERS.push({ name, email, role: role[0].toUpperCase()+role.slice(1) });
        renderUsers();
        alert('Invite sent (demo).');
      });
      document.getElementById('btnSavePK').addEventListener('click', ()=> alert('PassKit saved (demo).'));
      document.getElementById('btnSaveFX').addEventListener('click', ()=> alert('Foodics saved (demo).'));
      document.getElementById('btnSaveTW').addEventListener('click', ()=> alert('Twilio saved (demo).'));
      document.getElementById('btnSaveAll').addEventListener('click', ()=> alert('All settings saved (demo).'));
    })();
  </script>
    </body>
</html>